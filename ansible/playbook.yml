---
- name: 1) Base setup (containerd + kube tools) su nodi Kubernetes
  hosts: k8s_cluster
  become: yes
  roles:
    - setup

- name: 1b) Base setup (containerd only) su nodi edge
  hosts: edge_nodes
  become: yes
  roles:
    - edge_setup

- name: 2) Inizializza master e pubblica join command
  hosts: masters
  become: yes
  roles:
    - master

- name: 3) Join automatico dei worker
  hosts: workers
  become: yes
  roles:
    - workers

- name: 4) Installazione e configurazione KubeEdge
  hosts: masters
  become: yes
  roles:
    - kubeedge

- name: 5) Join automatico del nodo edge
  hosts: edge_nodes
  become: yes
  roles:
    - kubeedge_edge

- name: 6) Deploy Open5GS con persistent volumes e OVS-CNI
  hosts: masters
  become: yes
  roles:
    - open5gs

- name: 7) Installazione dashboard e monitoring
  hosts: masters
  become: yes
  roles:
    - monitoring

- name: 8) Deploy servizi IoT medici simulati
  hosts: masters
  become: yes
  roles:
    - healthcare

- name: 9) Test di carico e verifica funzionalit√† KubeEdge
  hosts: masters
  become: yes
  roles:
    - load_testing
